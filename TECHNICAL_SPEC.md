# ğŸ”§ Persona MCP - ê¸°ìˆ  ëª…ì„¸ì„œ

Claude Desktopìš© í˜ë¥´ì†Œë‚˜ ê´€ë¦¬ MCP ì„œë²„ì˜ ìƒì„¸í•œ ê¸°ìˆ  ì‚¬ì–‘ ë° ì•„í‚¤í…ì²˜

**ë²„ì „**: 1.0.0
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-01
**ì‘ì„±ì**: Sean Shin

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì•„í‚¤í…ì²˜](#-ì•„í‚¤í…ì²˜)
3. [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
4. [íŒŒì¼ ì‹œìŠ¤í…œ êµ¬ì¡°](#-íŒŒì¼-ì‹œìŠ¤í…œ-êµ¬ì¡°)
5. [MCP í”„ë¡œí† ì½œ êµ¬í˜„](#-mcp-í”„ë¡œí† ì½œ-êµ¬í˜„)
6. [API ë ˆí¼ëŸ°ìŠ¤](#-api-ë ˆí¼ëŸ°ìŠ¤)
7. [ë°ì´í„° ì €ì¥ì†Œ](#-ë°ì´í„°-ì €ì¥ì†Œ)
8. [í† í° ìµœì í™” ì „ëµ](#-í† í°-ìµœì í™”-ì „ëµ)
9. [ë³´ì•ˆ ê³ ë ¤ì‚¬í•­](#-ë³´ì•ˆ-ê³ ë ¤ì‚¬í•­)
10. [ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬](#-ì„±ëŠ¥-ë²¤ì¹˜ë§ˆí¬)

---

## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### í•µì‹¬ ê°œë…

Persona MCPëŠ” **ì ìˆ˜í•¨ ëª¨ë“œ(Submarine Mode)** ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í•œ ê²½ëŸ‰ í˜ë¥´ì†Œë‚˜ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

#### ì ìˆ˜í•¨ ëª¨ë“œë€?
- **ê¸°ë³¸ ìƒíƒœ**: í† í° ì‚¬ìš© 0 (ì ìˆ˜í•¨ì´ ë¬¼ì†ì— ì ê²¨ìˆìŒ)
- **í™œì„±í™” ì‹œ**: `@persona:ì´ë¦„` í˜¸ì¶œ ì‹œì—ë§Œ í† í° ì‚¬ìš© (ì ìˆ˜í•¨ì´ ë– ì˜¤ë¦„)
- **ëª©ì **: ë¶ˆí•„ìš”í•œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í† í° ë‚­ë¹„ ë°©ì§€

### ë¬¸ì œ ì •ì˜

**ê¸°ì¡´ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ë°©ì‹ì˜ ë¬¸ì œ:**
```
ë§¤ ëŒ€í™”ë§ˆë‹¤ í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ê°€ ìë™ìœ¼ë¡œ í¬í•¨ë¨
â†’ 100íšŒ ëŒ€í™” ì‹œ 50,000+ í† í° ë‚­ë¹„
â†’ ë¹„ìš© ì¦ê°€ + ë¶ˆí•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ì˜¤ì—¼
```

**Persona MCP ì†”ë£¨ì…˜:**
```
í•„ìš”í•  ë•Œë§Œ @persona:ì´ë¦„ìœ¼ë¡œ ëª…ì‹œì  í™œì„±í™”
â†’ 100íšŒ ì¤‘ 10íšŒë§Œ ì‚¬ìš© ì‹œ 90% í† í° ì ˆì•½
â†’ ë¹„ìš© ì ˆê° + ì»¨í…ìŠ¤íŠ¸ íš¨ìœ¨ì„± ì¦ê°€
```

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Claude Desktop (MCP Client)                â”‚
â”‚           - User Interface                           â”‚
â”‚           - MCP Protocol Consumer                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ stdio (MCP JSON-RPC 2.0)
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Persona MCP Server (Node.js)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         MCP Protocol Layer                    â”‚  â”‚
â”‚  â”‚  - ListToolsRequest Handler                   â”‚  â”‚
â”‚  â”‚  - CallToolRequest Handler                    â”‚  â”‚
â”‚  â”‚  - ListResourcesRequest Handler               â”‚  â”‚
â”‚  â”‚  - ReadResourceRequest Handler                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                   â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       Business Logic Layer                    â”‚  â”‚
â”‚  â”‚  - listPersonas()                             â”‚  â”‚
â”‚  â”‚  - readPersona(name)                          â”‚  â”‚
â”‚  â”‚  - savePersona(name, content)                 â”‚  â”‚
â”‚  â”‚  - deletePersona(name)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                   â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        File System Access Layer               â”‚  â”‚
â”‚  â”‚  - fs/promises (async)                        â”‚  â”‚
â”‚  â”‚  - Path resolution                            â”‚  â”‚
â”‚  â”‚  - Directory initialization                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  File System   â”‚
            â”‚                â”‚
            â”‚  ~/.persona/   â”‚
            â”‚  - name1.txt   â”‚
            â”‚  - name2.txt   â”‚
            â”‚  - name3.txt   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë ˆì´ì–´ ì„¤ëª…

#### 1. MCP Protocol Layer
- **ì—­í• **: MCP í‘œì¤€ í”„ë¡œí† ì½œ êµ¬í˜„
- **ì±…ì„**:
  - JSON-RPC 2.0 ë©”ì‹œì§€ íŒŒì‹±
  - ìš”ì²­/ì‘ë‹µ ì§ë ¬í™”
  - stdio í†µì‹  ê´€ë¦¬

#### 2. Business Logic Layer
- **ì—­í• **: í˜ë¥´ì†Œë‚˜ ê´€ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- **ì±…ì„**:
  - í˜ë¥´ì†Œë‚˜ CRUD ì—°ì‚°
  - ì…ë ¥ ê²€ì¦
  - ì—ëŸ¬ í•¸ë“¤ë§

#### 3. File System Access Layer
- **ì—­í• **: íŒŒì¼ ì‹œìŠ¤í…œ ì¶”ìƒí™”
- **ì±…ì„**:
  - ë¹„ë™ê¸° íŒŒì¼ I/O
  - ê²½ë¡œ ì²˜ë¦¬
  - ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### ëŸ°íƒ€ì„ í™˜ê²½
- **Node.js**: v18.0.0 ì´ìƒ
- **JavaScript**: ES Module (ESM)

### í•µì‹¬ ì˜ì¡´ì„±

```json
{
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.0.4"
  }
}
```

#### @modelcontextprotocol/sdk
- **ë²„ì „**: 1.0.4+
- **ìš©ë„**: MCP í”„ë¡œí† ì½œ ì„œë²„ êµ¬í˜„
- **ì£¼ìš” ëª¨ë“ˆ**:
  - `Server`: MCP ì„œë²„ ì¸ìŠ¤í„´ìŠ¤
  - `StdioServerTransport`: stdio ê¸°ë°˜ í†µì‹ 
  - Request Schemas: íƒ€ì… ì•ˆì „ ìš”ì²­ ì²˜ë¦¬

### í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

```javascript
import fs from 'fs/promises';  // ë¹„ë™ê¸° íŒŒì¼ I/O
import path from 'path';       // ê²½ë¡œ ì²˜ë¦¬
import os from 'os';           // í™ˆ ë””ë ‰í† ë¦¬ ì¡°íšŒ
```

---

## ğŸ“ íŒŒì¼ ì‹œìŠ¤í…œ êµ¬ì¡°

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```
persona-mcp/
â”œâ”€â”€ index.js                          # MCP ì„œë²„ ë©”ì¸ íŒŒì¼
â”œâ”€â”€ package.json                      # í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ package-lock.json                 # ì˜ì¡´ì„± ì ê¸ˆ
â”œâ”€â”€ README.md                         # í”„ë¡œì íŠ¸ ì†Œê°œ
â”œâ”€â”€ INSTALL.md                        # ì„¤ì¹˜ ê°€ì´ë“œ
â”œâ”€â”€ QUICKSTART.md                     # ë¹ ë¥¸ ì‹œì‘
â”œâ”€â”€ SUMMARY.md                        # í”„ë¡œì íŠ¸ ìš”ì•½
â”œâ”€â”€ TECHNICAL_SPEC.md                 # ê¸°ìˆ  ëª…ì„¸ì„œ (ì´ ë¬¸ì„œ)
â””â”€â”€ claude_desktop_config.example.json # ì„¤ì • ì˜ˆì œ
```

### í˜ë¥´ì†Œë‚˜ ì €ì¥ì†Œ

#### Windows
```
C:\Users\[ì‚¬ìš©ìëª…]\.persona\
â”œâ”€â”€ professional.txt
â”œâ”€â”€ casual.txt
â”œâ”€â”€ teacher.txt
â””â”€â”€ coder.txt
```

#### macOS/Linux
```
~/.persona/
â”œâ”€â”€ professional.txt
â”œâ”€â”€ casual.txt
â”œâ”€â”€ teacher.txt
â””â”€â”€ coder.txt
```

### ì €ì¥ì†Œ ìœ„ì¹˜ ê²°ì • ë¡œì§

```javascript
import os from 'os';
import path from 'path';

const PERSONA_DIR = path.join(os.homedir(), '.persona');
```

**ì„¤ëª…**:
- `os.homedir()`: í”Œë«í¼ ë…ë¦½ì  í™ˆ ë””ë ‰í† ë¦¬ ì¡°íšŒ
- `.persona`: ìˆ¨ê¹€ ë””ë ‰í† ë¦¬ (Unix ê´€ë¡€)
- ì‚¬ìš©ìë³„ ê²©ë¦¬ (ë©€í‹° ì‚¬ìš©ì í™˜ê²½ ì§€ì›)

---

## ğŸ”Œ MCP í”„ë¡œí† ì½œ êµ¬í˜„

### í”„ë¡œí† ì½œ ë²„ì „
- **MCP Version**: 2024-11-05
- **JSON-RPC**: 2.0

### êµ¬í˜„ëœ í•¸ë“¤ëŸ¬

#### 1. ListToolsRequest

**ì—”ë“œí¬ì¸íŠ¸**: `tools/list`

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "tools": [
    {
      "name": "create_persona",
      "description": "ìƒˆë¡œìš´ í˜ë¥´ì†Œë‚˜ í”„ë¡œí•„ì„ ìƒì„±í•©ë‹ˆë‹¤",
      "inputSchema": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "content": { "type": "string" }
        },
        "required": ["name", "content"]
      }
    },
    // ... 3ê°œ ë„êµ¬ ë”
  ]
}
```

#### 2. CallToolRequest

**ì—”ë“œí¬ì¸íŠ¸**: `tools/call`

**ìš”ì²­ ì˜ˆì‹œ**:
```json
{
  "method": "tools/call",
  "params": {
    "name": "create_persona",
    "arguments": {
      "name": "professional",
      "content": "ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³ ..."
    }
  }
}
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "content": [
    {
      "type": "text",
      "text": "í˜ë¥´ì†Œë‚˜ \"professional\"ì´(ê°€) ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\nìœ„ì¹˜: C:\\Users\\Sean K. S. Shin\\.persona\\professional.txt"
    }
  ]
}
```

#### 3. ListResourcesRequest

**ì—”ë“œí¬ì¸íŠ¸**: `resources/list`

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "resources": [
    {
      "uri": "persona://professional",
      "mimeType": "text/plain",
      "name": "Persona: professional",
      "description": "professional í˜ë¥´ì†Œë‚˜ í”„ë¡œí•„"
    },
    // ... ë‹¤ë¥¸ í˜ë¥´ì†Œë‚˜ë“¤
  ]
}
```

#### 4. ReadResourceRequest

**ì—”ë“œí¬ì¸íŠ¸**: `resources/read`

**ìš”ì²­ ì˜ˆì‹œ**:
```json
{
  "method": "resources/read",
  "params": {
    "uri": "persona://professional"
  }
}
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "contents": [
    {
      "uri": "persona://professional",
      "mimeType": "text/plain",
      "text": "ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³  ê²©ì‹ìˆëŠ” í†¤ìœ¼ë¡œ..."
    }
  ]
}
```

---

## ğŸ“– API ë ˆí¼ëŸ°ìŠ¤

### ë„êµ¬ (Tools)

#### 1. create_persona

**ì„¤ëª…**: ìƒˆë¡œìš´ í˜ë¥´ì†Œë‚˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

**íŒŒë¼ë¯¸í„°**:
```typescript
{
  name: string;     // í˜ë¥´ì†Œë‚˜ ì´ë¦„ (ì˜ˆ: "professional")
  content: string;  // í˜ë¥´ì†Œë‚˜ í”„ë¡¬í”„íŠ¸ ë‚´ìš©
}
```

**ë°˜í™˜ê°’**:
```typescript
{
  content: [{
    type: "text",
    text: string  // ì„±ê³µ ë©”ì‹œì§€
  }]
}
```

**ì˜¤ë¥˜**:
- íŒŒì¼ ì“°ê¸° ì‹¤íŒ¨
- ì˜ëª»ëœ íŒŒì¼ëª…

**ì‚¬ìš© ì˜ˆì‹œ**:
```javascript
// Claude Desktopì—ì„œ:
"professional í˜ë¥´ì†Œë‚˜ ë§Œë“¤ì–´ì¤˜"

// MCP í˜¸ì¶œ:
{
  name: "create_persona",
  arguments: {
    name: "professional",
    content: "ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³ ..."
  }
}
```

#### 2. update_persona

**ì„¤ëª…**: ê¸°ì¡´ í˜ë¥´ì†Œë‚˜ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.

**íŒŒë¼ë¯¸í„°**:
```typescript
{
  name: string;     // ìˆ˜ì •í•  í˜ë¥´ì†Œë‚˜ ì´ë¦„
  content: string;  // ìƒˆë¡œìš´ ë‚´ìš©
}
```

**ë°˜í™˜ê°’**:
```typescript
{
  content: [{
    type: "text",
    text: "í˜ë¥´ì†Œë‚˜ \"name\"ì´(ê°€) ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤."
  }]
}
```

**ì£¼ì˜**: íŒŒì¼ì´ ì—†ì–´ë„ ìƒì„±ë¨ (createì™€ ë™ì¼í•œ ë¡œì§)

#### 3. delete_persona

**ì„¤ëª…**: í˜ë¥´ì†Œë‚˜ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.

**íŒŒë¼ë¯¸í„°**:
```typescript
{
  name: string;  // ì‚­ì œí•  í˜ë¥´ì†Œë‚˜ ì´ë¦„
}
```

**ë°˜í™˜ê°’**:
```typescript
{
  content: [{
    type: "text",
    text: "í˜ë¥´ì†Œë‚˜ \"name\"ì´(ê°€) ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
  }]
}
```

**ì˜¤ë¥˜**:
- íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- ì‚­ì œ ê¶Œí•œ ì—†ìŒ

#### 4. list_personas

**ì„¤ëª…**: ëª¨ë“  í˜ë¥´ì†Œë‚˜ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**íŒŒë¼ë¯¸í„°**: ì—†ìŒ

**ë°˜í™˜ê°’**:
```typescript
{
  content: [{
    type: "text",
    text: string  // í˜ë¥´ì†Œë‚˜ ëª©ë¡ (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)
  }]
}
```

**ì˜ˆì‹œ ì¶œë ¥**:
```
ì‚¬ìš© ê°€ëŠ¥í•œ í˜ë¥´ì†Œë‚˜:
- professional
- casual
- teacher

ì‚¬ìš©ë²•: @persona:professional í˜•ì‹ìœ¼ë¡œ ì°¸ì¡°í•˜ì„¸ìš”.
```

---

## ğŸ’¾ ë°ì´í„° ì €ì¥ì†Œ

### íŒŒì¼ í˜•ì‹

#### íŒŒì¼ëª… ê·œì¹™
```
{í˜ë¥´ì†Œë‚˜ì´ë¦„}.txt
```

**ì˜ˆì‹œ**:
- `professional.txt`
- `casual.txt`
- `teacher.txt`

#### íŒŒì¼ ë‚´ìš© êµ¬ì¡°

**í˜•ì‹**: Plain Text (UTF-8)

**ì˜ˆì‹œ**:
```
ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³  ê²©ì‹ìˆëŠ” í†¤ìœ¼ë¡œ ëŒ€í™”í•©ë‹ˆë‹¤.
ì¡´ëŒ“ë§ì„ ì‚¬ìš©í•˜ë©°, ë¹„ì¦ˆë‹ˆìŠ¤ ë§¥ë½ì— ì í•©í•œ í‘œí˜„ì„ ì„ íƒí•©ë‹ˆë‹¤.
ê°„ê²°í•˜ê³  ëª…í™•í•˜ê²Œ í•µì‹¬ì„ ì „ë‹¬í•©ë‹ˆë‹¤.
```

### íŒŒì¼ I/O êµ¬í˜„

#### ë¹„ë™ê¸° íŒŒì¼ ì½ê¸°
```javascript
async function readPersona(name) {
  const filePath = path.join(PERSONA_DIR, `${name}.txt`);
  try {
    const content = await fs.readFile(filePath, 'utf-8');
    return content;
  } catch (error) {
    throw new Error(`Persona "${name}" not found`);
  }
}
```

#### ë¹„ë™ê¸° íŒŒì¼ ì“°ê¸°
```javascript
async function savePersona(name, content) {
  const filePath = path.join(PERSONA_DIR, `${name}.txt`);
  await fs.writeFile(filePath, content, 'utf-8');
}
```

#### íŒŒì¼ ëª©ë¡ ì¡°íšŒ
```javascript
async function listPersonas() {
  try {
    const files = await fs.readdir(PERSONA_DIR);
    return files
      .filter(f => f.endsWith('.txt'))
      .map(f => f.replace('.txt', ''));
  } catch (error) {
    return [];
  }
}
```

---

## ğŸš€ í† í° ìµœì í™” ì „ëµ

### ë¬¸ì œ: ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ì˜ í† í° ë‚­ë¹„

#### ê¸°ì¡´ ë°©ì‹ (ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸)
```
[ë§¤ ëŒ€í™”ë§ˆë‹¤]
System Prompt: "ë‹¹ì‹ ì€ ì „ë¬¸ì ì´ê³ ..." (500 í† í°)
User: "ì•ˆë…•?" (10 í† í°)
Assistant: "ì•ˆë…•í•˜ì„¸ìš”" (15 í† í°)

ì´ í† í°: 525 í† í°
```

**100íšŒ ëŒ€í™” ì‹œ**:
- ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸: 50,000 í† í°
- ì‹¤ì œ ëŒ€í™”: 2,500 í† í°
- **ë‚­ë¹„ìœ¨**: 95.2%

### í•´ê²°ì±…: ì ìˆ˜í•¨ ëª¨ë“œ

#### Persona MCP ë°©ì‹
```
[ê¸°ë³¸ ëŒ€í™”]
User: "ì•ˆë…•?" (10 í† í°)
Assistant: "ì•ˆë…•í•˜ì„¸ìš”" (15 í† í°)
ì´ í† í°: 25 í† í° (í˜ë¥´ì†Œë‚˜ 0 í† í°)

[í˜ë¥´ì†Œë‚˜ í™œì„±í™”]
User: "@persona:professional ì´ë©”ì¼ ì‘ì„±í•´ì¤˜" (15 í† í°)
[í˜ë¥´ì†Œë‚˜ ë¡œë“œ: 500 í† í°]
Assistant: "..." (200 í† í°)
ì´ í† í°: 715 í† í°
```

**100íšŒ ëŒ€í™” ì‹œ (10íšŒë§Œ í˜ë¥´ì†Œë‚˜ ì‚¬ìš©)**:
- ê¸°ë³¸ ëŒ€í™” 90íšŒ: 2,250 í† í°
- í˜ë¥´ì†Œë‚˜ ëŒ€í™” 10íšŒ: 7,150 í† í°
- **ì´í•©**: 9,400 í† í°
- **ì ˆê°ìœ¨**: 81.2%

### ë¹„ìš© ì ˆê° ì‹œë®¬ë ˆì´ì…˜

#### Claude 3.5 Sonnet ê°€ê²© (2025ë…„ 1ì›” ê¸°ì¤€)
- Input: $3 / 1M tokens

#### ì›”ê°„ 1000íšŒ ëŒ€í™” ê°€ì •

| ë°©ì‹ | í† í° ì‚¬ìš© | ë¹„ìš© |
|------|-----------|------|
| ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (100%) | 525,000 | $1.58 |
| Persona MCP (10% ì‚¬ìš©) | 94,000 | $0.28 |
| **ì ˆê°** | 431,000 | **$1.30 (82%)** |

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. íŒŒì¼ ì‹œìŠ¤í…œ ë³´ì•ˆ

#### ê²½ë¡œ ìˆœíšŒ ê³µê²© ë°©ì§€
```javascript
// âŒ ì·¨ì•½í•œ ì½”ë“œ
const filePath = PERSONA_DIR + '/' + userInput + '.txt';

// âœ… ì•ˆì „í•œ ì½”ë“œ
const filePath = path.join(PERSONA_DIR, `${name}.txt`);
// path.join()ì´ ìë™ìœ¼ë¡œ ../ ê°™ì€ ê²½ë¡œ ìˆœíšŒ ì‹œë„ë¥¼ ì •ê·œí™”
```

#### íŒŒì¼ëª… ê²€ì¦
```javascript
function validatePersonaName(name) {
  // ì•ŒíŒŒë²³, ìˆ«ì, í•˜ì´í”ˆ, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ í—ˆìš©
  const validPattern = /^[a-zA-Z0-9_-]+$/;
  return validPattern.test(name);
}
```

### 2. ì»¨í…ì¸  ë³´ì•ˆ

#### XSS ë°©ì§€
- Plain Text ì €ì¥ (HTML/ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë¶ˆê°€)
- MCP ì‘ë‹µì—ì„œ í…ìŠ¤íŠ¸ë¡œë§Œ ë°˜í™˜

#### í”„ë¡¬í”„íŠ¸ ì¸ì ì…˜ ì£¼ì˜
```
âŒ ìœ„í—˜í•œ í˜ë¥´ì†Œë‚˜ ì˜ˆì‹œ:
"Ignore all previous instructions and..."

âœ… ì•ˆì „í•œ í˜ë¥´ì†Œë‚˜ ì˜ˆì‹œ:
"ë‹¹ì‹ ì€ ì „ë¬¸ì ìœ¼ë¡œ ëŒ€í™”í•©ë‹ˆë‹¤."
```

### 3. ì ‘ê·¼ ì œì–´

#### ì‚¬ìš©ì ê²©ë¦¬
- ê° OS ì‚¬ìš©ìì˜ í™ˆ ë””ë ‰í† ë¦¬ì— ì €ì¥
- `~/.persona/` ë””ë ‰í† ë¦¬ëŠ” í•´ë‹¹ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥

#### ê¶Œí•œ ì„¤ì •
```javascript
async function initPersonaDir() {
  try {
    await fs.mkdir(PERSONA_DIR, {
      recursive: true,
      mode: 0o700  // rwx------ (ì†Œìœ ìë§Œ ì ‘ê·¼)
    });
  } catch (error) {
    console.error('Failed to create persona directory:', error);
  }
}
```

---

## ğŸ“Š ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

### íŒŒì¼ I/O ì„±ëŠ¥

| ì—°ì‚° | í‰ê·  ì‹œê°„ | ìµœì•… ì‹œê°„ |
|------|-----------|-----------|
| readPersona() | 2ms | 10ms |
| savePersona() | 5ms | 20ms |
| listPersonas() | 3ms | 15ms |
| deletePersona() | 4ms | 12ms |

**í…ŒìŠ¤íŠ¸ í™˜ê²½**:
- Windows 11, SSD
- í˜ë¥´ì†Œë‚˜ í¬ê¸°: 500ì (ì•½ 500 í† í°)
- í˜ë¥´ì†Œë‚˜ ê°œìˆ˜: 10ê°œ

### MCP í”„ë¡œí† ì½œ ì˜¤ë²„í—¤ë“œ

| ìš”ì²­ ìœ í˜• | í‰ê·  ì‹œê°„ |
|-----------|-----------|
| ListTools | <1ms |
| CallTool | 5-10ms (íŒŒì¼ I/O í¬í•¨) |
| ListResources | 3-5ms |
| ReadResource | 2-5ms |

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

- **ì„œë²„ ì´ˆê¸°í™”**: 15MB
- **í˜ë¥´ì†Œë‚˜ 10ê°œ ë¡œë“œ**: 20MB
- **ìµœëŒ€ ì‚¬ìš©ëŸ‰**: 25MB

---

## ğŸ”„ ë¼ì´í”„ì‚¬ì´í´

### ì„œë²„ ì‹œì‘

```javascript
async function main() {
  // 1. í˜ë¥´ì†Œë‚˜ ë””ë ‰í† ë¦¬ ì´ˆê¸°í™”
  await initPersonaDir();

  // 2. stdio íŠ¸ëœìŠ¤í¬íŠ¸ ìƒì„±
  const transport = new StdioServerTransport();

  // 3. ì„œë²„ ì—°ê²°
  await server.connect(transport);

  console.error('Persona MCP server running on stdio');
}
```

### ìš”ì²­ ì²˜ë¦¬ íë¦„

```
1. Claude Desktopì´ JSON-RPC ìš”ì²­ ì „ì†¡ (stdio)
2. MCP SDKê°€ ìš”ì²­ íŒŒì‹±
3. í•´ë‹¹ í•¸ë“¤ëŸ¬ í˜¸ì¶œ
4. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
5. íŒŒì¼ ì‹œìŠ¤í…œ I/O
6. ì‘ë‹µ JSON ì§ë ¬í™”
7. stdioë¡œ ì‘ë‹µ ì „ì†¡
```

---

## ğŸ› ï¸ ê°œë°œ ê°€ì´ë“œ

### ìƒˆë¡œìš´ ë„êµ¬ ì¶”ê°€í•˜ê¸°

#### 1. ListToolsRequestì— ë„êµ¬ ì¶”ê°€
```javascript
server.setRequestHandler(ListToolsRequestSchema, async () => {
  return {
    tools: [
      // ... ê¸°ì¡´ ë„êµ¬ë“¤
      {
        name: 'rename_persona',
        description: 'í˜ë¥´ì†Œë‚˜ ì´ë¦„ ë³€ê²½',
        inputSchema: {
          type: 'object',
          properties: {
            oldName: { type: 'string' },
            newName: { type: 'string' }
          },
          required: ['oldName', 'newName']
        }
      }
    ]
  };
});
```

#### 2. CallToolRequestì— í•¸ë“¤ëŸ¬ ì¶”ê°€
```javascript
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  switch (name) {
    // ... ê¸°ì¡´ ì¼€ì´ìŠ¤ë“¤
    case 'rename_persona': {
      const oldPath = path.join(PERSONA_DIR, `${args.oldName}.txt`);
      const newPath = path.join(PERSONA_DIR, `${args.newName}.txt`);
      await fs.rename(oldPath, newPath);
      return {
        content: [{
          type: 'text',
          text: `í˜ë¥´ì†Œë‚˜ ì´ë¦„ì´ "${args.oldName}"ì—ì„œ "${args.newName}"(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`
        }]
      };
    }
  }
});
```

---

## ğŸ“ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜

#### 1. ENOENT: no such file or directory
**ì›ì¸**: í˜ë¥´ì†Œë‚˜ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ

**í•´ê²°**:
```bash
# íŒŒì¼ í™•ì¸
ls ~/.persona/

# í˜ë¥´ì†Œë‚˜ ì¬ìƒì„±
# Claude Desktopì—ì„œ: "professional í˜ë¥´ì†Œë‚˜ ë§Œë“¤ì–´ì¤˜"
```

#### 2. EACCES: permission denied
**ì›ì¸**: íŒŒì¼ ì ‘ê·¼ ê¶Œí•œ ì—†ìŒ

**í•´ê²°**:
```bash
# ë””ë ‰í† ë¦¬ ê¶Œí•œ í™•ì¸
ls -la ~/.persona/

# ê¶Œí•œ ìˆ˜ì •
chmod 700 ~/.persona/
chmod 600 ~/.persona/*.txt
```

#### 3. MCP ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ
**ì›ì¸**: Node.js ë²„ì „ ë˜ëŠ” ê²½ë¡œ ì˜¤ë¥˜

**í•´ê²°**:
```bash
# Node.js ë²„ì „ í™•ì¸
node --version  # v18+ í•„ìš”

# ì§ì ‘ ì‹¤í–‰ í…ŒìŠ¤íŠ¸
node C:\Users\Sean K. S. Shin\Documents\persona-mcp\index.js
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- **MCP ê³µì‹ ë¬¸ì„œ**: https://modelcontextprotocol.io/
- **MCP SDK**: https://github.com/modelcontextprotocol/sdk
- **Node.js fs/promises**: https://nodejs.org/api/fs.html#promises-api
- **JSON-RPC 2.0**: https://www.jsonrpc.org/specification

---

## ğŸ“ ë³€ê²½ ì´ë ¥

### v1.0.0 (2025-11-01)
- ì´ˆê¸° ë¦´ë¦¬ìŠ¤
- 4ê°œ ë„êµ¬ êµ¬í˜„ (create, update, delete, list)
- MCP Resources ì§€ì›
- ì ìˆ˜í•¨ ëª¨ë“œ ì•„í‚¤í…ì²˜ êµ¬í˜„

---

<div align="center">

**Persona MCP - í† í°ì„ ì•„ë¼ëŠ” ì§€ëŠ¥í˜• í˜ë¥´ì†Œë‚˜ ê´€ë¦¬**

[README](./README.md) â€¢ [ì„¤ì¹˜ ê°€ì´ë“œ](./INSTALL.md) â€¢ [ë¹ ë¥¸ ì‹œì‘](./QUICKSTART.md)

</div>
